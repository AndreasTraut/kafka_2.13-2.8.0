[2021-04-26 16:12:42,470] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2021-04-26 16:12:42,494] INFO [Controller id=0 epoch=4] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2021-04-26 16:12:42,496] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0) for 4 partitions (state.change.logger)
[2021-04-26 16:12:42,531] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2021-04-26 16:12:42,549] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 4 as part of the become-leader transition for 2 partitions (state.change.logger)
[2021-04-26 16:12:42,730] INFO [Controller id=0 epoch=4] Partition second-0 state changed to (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-04-26 16:12:42,731] INFO [Controller id=0 epoch=4] Partition first-1 state changed to (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-04-26 16:12:42,731] INFO [Controller id=0 epoch=4] Partition second-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-04-26 16:12:42,731] INFO [Controller id=0 epoch=4] Partition first-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2021-04-26 16:12:42,732] INFO [Controller id=0 epoch=4] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2021-04-26 16:12:42,732] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0) for 4 partitions (state.change.logger)
[2021-04-26 16:12:42,920] INFO [Controller id=0 epoch=4] Changed partition second-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), zkVersion=2) (state.change.logger)
[2021-04-26 16:12:42,920] INFO [Controller id=0 epoch=4] Changed partition first-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), zkVersion=2) (state.change.logger)
[2021-04-26 16:12:42,921] INFO [Controller id=0 epoch=4] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2021-04-26 16:12:42,921] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0) for 2 partitions (state.change.logger)
[2021-04-26 16:12:43,088] INFO [Broker id=0] Leader second-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:12:43,354] INFO [Broker id=0] Leader first-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:12:43,706] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 4 for partition first-0 (last update controller epoch 2) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2021-04-26 16:12:43,717] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 4 for partition second-1 (last update controller epoch 2) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2021-04-26 16:12:43,724] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2021-04-26 16:12:43,730] INFO [Broker id=0] Finished LeaderAndIsr request in 1200ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2021-04-26 16:12:43,736] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 2 (state.change.logger)
[2021-04-26 16:12:43,737] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2021-04-26 16:12:44,315] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 4 as part of the become-leader transition for 2 partitions (state.change.logger)
[2021-04-26 16:12:44,317] INFO [Broker id=0] Leader second-0 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-04-26 16:12:44,435] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 4 for partition second-0 (last update controller epoch 4) since it is already the leader for the partition. (state.change.logger)
[2021-04-26 16:12:44,436] INFO [Broker id=0] Leader first-1 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2021-04-26 16:12:44,663] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 4 for partition first-1 (last update controller epoch 4) since it is already the leader for the partition. (state.change.logger)
[2021-04-26 16:12:44,664] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 4 for partition first-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2021-04-26 16:12:44,664] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 4 for partition second-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2021-04-26 16:12:44,664] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 4 with correlation id 3 for 0 partitions (state.change.logger)
[2021-04-26 16:12:44,664] INFO [Broker id=0] Finished LeaderAndIsr request in 927ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2021-04-26 16:12:44,665] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 4 (state.change.logger)
[2021-04-26 16:12:44,666] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2021-04-26 16:12:44,666] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 4 as part of the become-leader transition for 2 partitions (state.change.logger)
[2021-04-26 16:12:44,667] INFO [Broker id=0] Leader first-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:12:44,896] INFO [Broker id=0] Leader second-1 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:12:45,065] INFO [Broker id=0] Finished LeaderAndIsr request in 399ms correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2021-04-26 16:12:45,067] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 6 (state.change.logger)
[2021-04-26 16:13:18,133] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2021-04-26 16:13:18,134] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 4 partitions (state.change.logger)
[2021-04-26 16:13:18,136] INFO [Controller id=0 epoch=4] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2021-04-26 16:13:18,136] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1) for 4 partitions (state.change.logger)
[2021-04-26 16:13:18,137] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 8 (state.change.logger)
[2021-04-26 16:13:18,485] INFO [Broker id=1] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 0 (state.change.logger)
[2021-04-26 16:13:18,497] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2021-04-26 16:13:18,598] INFO [Broker id=1] Follower first-0 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:13:18,629] INFO [Broker id=1] Follower second-0 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:13:18,677] INFO [Broker id=1] Follower first-1 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:13:18,780] INFO [Broker id=1] Follower second-1 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2021-04-26 16:13:18,781] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 4 with correlation id 1 for 4 partitions (state.change.logger)
[2021-04-26 16:13:18,812] INFO [Broker id=1] Finished LeaderAndIsr request in 316ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2021-04-26 16:13:18,816] INFO [Broker id=1] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 2 (state.change.logger)
[2021-04-26 16:13:18,926] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2021-04-26 16:13:18,930] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 9 (state.change.logger)
[2021-04-26 16:13:18,931] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 3 (state.change.logger)
[2021-04-26 16:13:19,030] INFO [Controller id=0 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1) for 3 partitions (state.change.logger)
[2021-04-26 16:13:19,031] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 4 (state.change.logger)
[2021-04-26 16:13:19,031] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 4 with correlation id 10 (state.change.logger)
